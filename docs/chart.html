<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Ticker Chart</title>
    <style>
        body { margin: 0; padding: 8px; background: #ffffff; font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
        .chart-container { border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .chart-header { background: #f8f9fa; padding: 12px 16px; border-bottom: 1px solid #e1e5e9; 
                       font-weight: 600; color: #37352f; font-size: 14px; }
        .error { padding: 20px; text-align: center; color: #e74c3c; }
    </style>
</head>
<body>
    <div class="chart-container">
        <div class="chart-header" id="chart-title">Loading Chart...</div>
        <div id="tradingview-chart" style="height: 400px;"></div>
        <div id="error-message" class="error" style="display: none;">
            Invalid ticker symbol. Please check the URL parameters.
        </div>
    </div>

    <script src="https://s3.tradingview.com/tv.js"></script>
    <script>
        // Parse URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const ticker = urlParams.get('ticker') || 'AAPL';
        const exchange = urlParams.get('exchange') || 'NASDAQ';
        const interval = urlParams.get('interval') || 'D';
        const theme = urlParams.get('theme') || 'light';
        
        const symbol = exchange + ':' + ticker;
        const title = ticker + ' Chart';
        
        // Update title
        document.getElementById('chart-title').textContent = title;
        document.title = title;
        
        try {
            new TradingView.widget({
                container_id: "tradingview-chart",
                width: "100%",
                height: 400,
                symbol: symbol,
                interval: interval,
                timezone: "Etc/UTC",
                theme: theme,
                style: "1",
                locale: "en",
                toolbar_bg: "#f8f9fa",
                enable_publishing: false,
                withdateranges: true,
                allow_symbol_change: true,
                hide_side_toolbar: false,
                studies_overrides: {},
                overrides: {
                    "paneProperties.background": theme === 'dark' ? "#1e1e1e" : "#ffffff",
                    "paneProperties.vertGridProperties.color": theme === 'dark' ? "#333" : "#f0f0f0",
                    "paneProperties.horzGridProperties.color": theme === 'dark' ? "#333" : "#f0f0f0"
                }
            });
        } catch (error) {
            document.getElementById('tradingview-chart').style.display = 'none';
            document.getElementById('error-message').style.display = 'block';
        }
    </script>
</body>
</html>